let e;(async()=>{try{const e=await fetch("\n            https://api.themoviedb.org/3/genre/movie/list?api_key=ff98b74c6ada2972698b8eff6707845a&language=en-US\n        ");return await e.json()}catch(e){throw Error(response.statusText)}})().then((t=>{localStorage.setItem("genres",JSON.stringify(t.genres));const n=localStorage.getItem("genres");e=JSON.parse(n)}));const t=t=>t.map((({poster_path:t,title:n,name:o,release_date:a,first_air_date:r,genre_ids:s,id:c,vote_average:i})=>{let l,d=e.filter((({id:e})=>s.includes(e))).map((({name:e})=>e));l=d.length<=2?d.join(", "):d.slice(0,2).join(", ")+", Other";const u=i.toString();return`\n                <li class="card__item" data-id="${c}">\n                    <a class="card card__link" data-id="${c}">\n                        <img class="card__img" data-id="${c}" src='https://image.tmdb.org/t/p/w500${t}' alt='${n||o}' loading="lazy"/>\n                        <p class="card__title" data-id="${c}">${n||o}</p>\n                        <div class="card__inform" data-id="${c}">\n                            <p class="card__genres">${l}</p>\n                            <p class="card__date">\n                              <span></span>| \n                            ${(a||r).slice(0,4)}</p>\n                            <span class="card__vote visually-hidden">${u.slice(0,3)}</span>\n                        </div>\n                    </a>\n                </li>\n            `})).join(""),n={gallery:document.querySelector(".gallery"),form:document.querySelector(".navigation__form"),notificate:document.querySelector(".navigation__notificate"),backdrop:document.querySelector(".js-backdrop"),watchButton:document.querySelector(".button-watched__modal"),queueButton:document.querySelector(".button-queue__modal"),modal:document.querySelector(".modal__content"),closeModalBtn:document.querySelector(".modal-close"),buttonsContainer:document.querySelector(".buttons-modal"),queueBtnLib:document.querySelector(".button-queue"),watchedBtnLib:document.querySelector(".button-watched"),galleryLib:document.querySelector(".gallery-lib")};class o{getRefs(){const e={};return e.loader=document.querySelector(".loader"),e}show(){this.refs.loader.classList.remove("is-hidden")}hide(){this.refs.loader.classList.add("is-hidden")}constructor({hidden:e=!1}){this.refs=this.getRefs(),e&&this.hide()}}let a={currentPage:1,currentQueryPage:1};const r=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&((async e=>{try{e.show();const t=await fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=ff98b74c6ada2972698b8eff6707845a&page=${a.currentPage}`);return e.hide(),t.json()}catch(e){throw Error(response.statusText)}})(c).then((e=>{try{if(a.currentPage===e.total_pages)return n.gallery.insertAdjacentHTML("beforeend",t(e.results)),window.alert("Sorry this is the last page, we do not have any movies for you :("),void s();a.currentPage+=1,n.gallery.insertAdjacentHTML("beforeend",t(e.results))}catch(e){console.log(e)}})),console.log("is intersecting"))}))}),{rootMargin:"0px",threshold:1});function s(){r.unobserve(document.querySelector(".scroll-check"))}r.observe(document.querySelector(".scroll-check"));const c=new o({loader:".loader",hidden:!0});const i=async e=>{try{const t=await fetch(`\n        https://api.themoviedb.org/3/search/movie?api_key=ff98b74c6ada2972698b8eff6707845a&language=en-US&page=${a.currentQueryPage}&include_adult=false&query=${e}`);return a.currentQueryPage+=1,s(),await t.json()}catch(e){throw Error(response.statusText)}};new o({loader:".loader",hidden:!0});const l=new o({loader:".loader",hidden:!0});let d="";n.form.addEventListener("submit",(e=>{e.preventDefault();let o=e.target.elements.navigation__input.value;d=o.trim(),i(d).then((e=>{""===d||0===e.results.length?(n.notificate.classList.remove("navigation__notificate-hidden"),document.getElementById("myForm").reset(),setTimeout((()=>{n.notificate.classList.add("navigation__notificate-hidden")}),2500)):n.gallery.innerHTML=t(e.results),l.show()}));new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(s(),i(d).then((e=>{try{n.gallery.insertAdjacentHTML("beforeend",t(e.results))}catch(e){console.log(e)}})))}))}),{rootMargin:"-100px",threshold:1}).observe(document.querySelector(".scroll-check"))}));const u=document.getElementById("modalTeam"),g=document.querySelector(".modal-team");function h(e){const{vote_average:t,vote_count:n,genres:o,original_title:a,title:r,poster_path:s,original_name:c,popularity:i,overview:l,id:d}=e;return`\n        <img class="img-modal" src="https://image.tmdb.org/t/p/w500${s}" alt="" data-id=${d} />\n        <div class="container-modal">\n          <h1 class="title-modal">${r}</h1>\n          <table class="table">\n            <tr>\n              <th class="table__text">Vote / Votes</th>\n              <th><span class="vote-average">${t}</span> / <span class="vote-count">${n}</span></th>\n            </tr>\n            <tr>\n              <th class="table__text">Popularity</th>\n              <th>${i}</th>\n            </tr>\n            <tr>\n              <th class="table__text">Original Title</th>\n              <th>${a||c}</th>\n            </tr>\n            <tr>\n              <th class="table__text">Genre</th>\n              <th>${o?o.map((e=>e.name)):" "}</th>\n            </tr>\n          </table>\n          <h2 class="title-about__modal">ABOUT</h2>\n          <p class="about-text__modal">${l}\n          </p>\n        </div>\n      </div>\n    </div>`}let m;function f(){window.removeEventListener("keydown",p),n.backdrop.classList.remove("show-modal")}function y(e){e.currentTarget===e.target&&f()}function p(e){"Escape"===e.code&&f()}u.addEventListener("click",(function(e){e.preventDefault(),g.classList.toggle("visually-hidden"),g.addEventListener("keydown")})),window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),1e3)},n.gallery.addEventListener("click",(e=>{e.preventDefault(),async function(e){try{return(await fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=deeaaa6f7bb1ec2c1571c017660b3676`)).json()}catch(e){console.log(e.message)}}(e.target.dataset.id).then((e=>{m=e,n.modal.innerHTML="",v(),S(),window.addEventListener("keydown",p),n.backdrop.classList.add("show-modal"),n.modal.insertAdjacentHTML("afterbegin",h(e)),n.backdrop.addEventListener("click",y),n.closeModalBtn.addEventListener("click",f),n.buttonsContainer.addEventListener("click",w)})).catch((e=>{console.log(e)}))}));let _=[],b=[];function v(){localStorage.getItem("Watch")&&(_=JSON.parse(localStorage.getItem("Watch"))),localStorage.getItem("Queue")&&(b=JSON.parse(localStorage.getItem("Queue")))}function w(e){"button-watched__modal"!==e.target.className?"button-queue__modal"!==e.target.className||function(){if("ADD TO QUEUE"===n.queueButton.textContent)return q(),b.push(m),void localStorage.setItem("Queue",JSON.stringify(b));if("REMOVE FROM QUEUE"===n.queueButton.textContent){L();for(const e of b)if(e.id===m.id){const t=b.indexOf(e);b.splice(t,1);localStorage.setItem("Queue",JSON.stringify(b))}}}():function(){if(console.log(m),"ADD TO WATCHED"===n.watchButton.textContent)return E(),_.push(m),void localStorage.setItem("Watch",JSON.stringify(_));if("REMOVE FROM WATCH"===n.watchButton.textContent){k();for(const e of _)if(e.id===m.id){const t=_.indexOf(e);_.splice(t,1);localStorage.setItem("Watch",JSON.stringify(_))}}}()}function S(){k(),L();for(const e of _)if(e.id===m.id){E();break}for(const e of b)if(e.id===m.id){q();break}}function E(){n.watchButton.style.backgroundColor="red",n.watchButton.textContent="REMOVE FROM WATCH"}function k(){n.watchButton.style.backgroundColor="#FF6B01",n.watchButton.textContent="ADD TO WATCHED"}function q(){n.queueButton.style.backgroundColor="pink",n.queueButton.textContent="REMOVE FROM QUEUE"}function L(){n.queueButton.style.backgroundColor="white",n.queueButton.textContent="ADD TO QUEUE"}
//# sourceMappingURL=index.cc39a143.js.map
